#!/bin/bash

# Define the directory to scan for PHP files
directory_to_scan="/path/to/your/php/files"

# Define the vulnerable patterns to search for
vulnerable_patterns=(
    "eval("
    "exec("
    "system("
    "passthru("
    "shell_exec("
    "preg_replace('/\.\*/e',"
    # Add more patterns as needed to check for other vulnerabilities
)

echo "Scanning PHP files in $directory_to_scan for potential vulnerabilities..."

# Loop through each PHP file in the directory and check for vulnerabilities
for file in $(find "$directory_to_scan" -type f -name "*.php"); do
    echo "Checking $file..."
    for pattern in "${vulnerable_patterns[@]}"; do
        grep -H -n -i -E "$pattern" "$file"
    done
done

echo "Scan complete."
